\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}


\title{Stock Analysis}
\author{Raktim Dey}
\date{June 2022}

\begin{document}

\maketitle


I have used two models for the above Stock market data analysis- \\
\begin{itemize}
    \item Facebook prophet model
    \item LSTM stacked RNN
\end{itemize}

\section{Facebook prophet model}
After importing and installing the necessary libraries and the prophet model,
I added a date feature to the dataset which was needed to use the prophet model.
Then I removed the null values and visualised the features of the dataset.\\ \\

  \begin{figure}[htp]
        \centering
        \includegraphics[width=7cm]{vis1.png}
        \caption{RNN model}
        \label{fig:NIPS}
\end{figure}
Then I removed all but the date and the label feature needed for the prophet model.
After renaming them to 'ds' and 'y', I imported the prophet model and initialised the model with a 95\% confidence interval.
\\ \\

  \begin{figure}[htp]
        \centering
        \includegraphics[width=7cm]{prop1.png}
        \caption{Adj Close Value}
        \label{fig:NIPS}
\end{figure}

Then I fitted the dataset to the model and created a variable 'forecast' to predict the 'Adj Close' for the next 30 days. Then I plotted a graph showing the values for the entire training data and data generated by the model.
The blue line represents the 'Adj Close' values and the blue shaded region represents the bounding values of the above feature.

  \begin{figure}[htp]
        \centering
        \includegraphics[width=7cm]{prop2.png}
        \caption{Adj Close Value}
        \label{fig:NIPS}
\end{figure}


.


\section{LSTM stacked RNN}

After importing the data, I scaled the values of the label feature so that every value lies between 0 and 1. Then I split the dataset into training and testing data in a ratio 7:3. \\ \\

  \begin{figure}[htp]
        \centering
        \includegraphics[width=7cm]{rnn1.png}
        \caption{Adj Close Value}
        \label{fig:NIPS}
\end{figure}

Then I defined a function 'create\_sequences' to convert the values into a sequence of values in order to become an input for the LSTM layer. Then I split the data into input and features, where the first 30 values serve as input and the $31^{st}$
value serve as the label.\\ \\

Then I built an RNN with three LSTM layers each with 200 cells, and a final Dense layer with one neuron for the output. I used MSE as the loss function and adam optimizer. Then I fit my training data to the RNN model. \\ \\

  \begin{figure}[htp]
        \centering
        \includegraphics[width=7cm]{rnn2.png}
        \caption{RNN sequence}
        \label{fig:NIPS}
\end{figure}

After saving the model, I generated the values for the next 30 days by creating a sequence of 30 values, and everytime I generated a value, I truncated the first value of that sequence and appended the generated value to the sequence for the next value, and so on. \\ \\


  \begin{figure}[htp]
        \centering
        \includegraphics[width=7cm]{rnn3.png}
        \caption{Adj Close value}
        \label{fig:NIPS}
\end{figure}

Then I performed inverse transformation on the generated values to obtain the original values from the dataset. \\


Then I plotted a graph to visualise the original and the generated values.


\end{document}
